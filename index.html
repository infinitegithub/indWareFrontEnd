<!DOCTYPE html>
<html lang="en">

<link>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Search Store</title>
<link rel="stylesheet" href="style.css">
<a href="warehouses.html">Warehouses</a>
<a href="logout.html">Log Out</a>
<script src="keycloak.js"></script>
<script>


    var keycloak = new Keycloak();

    function initKeycloak() {
        keycloak.init({ onLoad: 'login-required' }).then(function () {
            constructTableRows(keycloak.idTokenParsed);
            pasteToken(keycloak.token);
        }).catch(function () {
            alert('failed to initialize');
        });
    }

    function constructTableRows(keycloakToken) {
        document.getElementById('row-username').innerHTML = keycloakToken.preferred_username;
        document.getElementById('row-firstName').innerHTML = keycloakToken.given_name;
        document.getElementById('row-lastName').innerHTML = keycloakToken.family_name;
        document.getElementById('row-name').innerHTML = keycloakToken.name;
        document.getElementById('row-email').innerHTML = keycloakToken.email;
    }

    function pasteToken(token) {
        document.getElementById('ta-token').value = token;
        document.getElementById('ta-refreshToken').value = keycloak.refreshToken;
    }

    var refreshToken = function () {
        keycloak.updateToken(-1)
            .then(function () {
                document.getElementById('ta-token').value = keycloak.token;
                document.getElementById('ta-refreshToken').value = keycloak.refreshToken;
            });
    }


</script>
</head>

<body onload="initKeycloak()">
    <h3 id="searchStore">Stores</h3>
    <div id="searchFeild">
        <input type="text" id="term" placeholder="Search Store..." />
        <button type="submit" class="btn" id="searchButton">Search</button>
    </div>
    <div id="result">
    </div>
    <div id="error">
    </div>
    <script src="main.js"></script>
    <script>
        document.getElementById("term").addEventListener("keyup", function (event) {
            event.preventDefault();
            if (event.keyCode === 13) {
                document.getElementById("searchButton").click();
            }
        });


    </script>
</body>

</html>